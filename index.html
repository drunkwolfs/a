<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8">
    <meta name="viewport"
          content="width=device-width, initial-scale=1.0, minimum-scale=1.0, maximum-scale=1.0, user-scalable=no"/>
    <meta name="format-detection" content="telephone=no"/>
    <meta http-equiv="X-UA-Compatible" content="IE=edge"/>
    <meta name="MobileOptimized" content="176"/>
    <meta name="HandheldFriendly" content="True"/>
    <meta name="robots" content="noindex,nofollow"/>
    <title></title>
    <link rel="stylesheet" href="home.css">
    <script type="text/javascript" src="https://ajax.googleapis.com/ajax/libs/jquery/3.4.1/jquery.min.js"></script>
    <script type="text/javascript" src="https://telegram.org/js/telegram-web-app.js?1"></script>
    <script>
      // Устанавливает стиль для светлой\темной темы
      function setThemeClass() {
        document.documentElement.className = Telegram.WebApp.colorScheme;
      }
      Telegram.WebApp.onEvent('themeChanged', setThemeClass);
      setThemeClass();

      //Подгрузка базы данных
      function getDecompressedJsonParam(paramName) {
          const urlParams = new URLSearchParams(window.location.search);
          const encodedParam = urlParams.get(paramName);
          
          if (!encodedParam) {
              console.log(`No parameter found for ${paramName}`);
              return null;
          }

          try {
              // Декодирование из Base64
              const base64Decoded = atob(encodedParam);

              // Преобразование строки в Uint8Array
              const charList = base64Decoded.split('').map(c => c.charCodeAt(0));
              const byteArray = new Uint8Array(charList);

              // Распаковка с помощью pako
              const decompressed = pako.inflate(byteArray, { to: 'string' });

              // Преобразование в JSON
              const json = JSON.parse(decompressed);
              return json;
          } catch (e) {
              console.error(`Error processing parameter ${paramName}:`, e);
              return null;
          }
      }
      const users = getDecompressedJsonParam('users');
      const items = getDecompressedJsonParam('items');

      console.log(users);
      console.log(items);

      //Навигация
      var pages = ['item_page.html', 'user_page.html'];
    </script>
  </head>

  <body>
    <table class="center" width="100%">
      <tr>
        <td colspan="2">
          <div id="content"><!-- Страницы --></div>
        </td>
      </tr>
      <tr>
        <td><button id="back-button" onclick="backPage()">Закрыть</button></td>
        <td><button id="next-button" onclick="nextPage()">Далее</button></td>
      </tr>
    </table>
  </body>

</html>