<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8">
    <meta name="viewport"
          content="width=device-width, initial-scale=1.0, minimum-scale=1.0, maximum-scale=1.0, user-scalable=no"/>
    <meta name="format-detection" content="telephone=no"/>
    <meta http-equiv="X-UA-Compatible" content="IE=edge"/>
    <meta name="MobileOptimized" content="176"/>
    <meta name="HandheldFriendly" content="True"/>
    <meta name="robots" content="noindex,nofollow"/>
    <title></title>
    <link rel="stylesheet" href="home.css">
    <script type="text/javascript" src="https://ajax.googleapis.com/ajax/libs/jquery/3.4.1/jquery.min.js"></script>
    <script type="text/javascript" src="https://telegram.org/js/telegram-web-app.js?1"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/pako/2.1.0/pako.min.js"></script>
    <script type="text/javascript" src="common.js"></script>
    <script>
      //Подгрузка базы данных
      const users = getDecompressedJsonParam('users');
      const items = modifItems(getDecompressedJsonParam('items'));
    </script>
  </head>
  <body>
    <table class="main-table">
      <tr>
        <td colspan="2">
          <div id="pages">
            <div id="select-items" style="display: block;">
              <table>
                <tr>
                  <td><select id="cmbTop"></select></td>
                  <td><div id="addBtn"><button onclick="addNumberInput()">Добавить</button></div></td>
                </tr>
                <tr>
                  <td colspan="2">
                     <table id="elements" class="center">
                      <tbody>
                      </tbody>
                      </table>
                  </td>
                </tr>
              </table>
            </div>
            <div id="select-user" style="display: none;">
              <table>
                <tr>
                  <td><select id="cmbUser"></select></td>
                  <td><div><button onclick="addClient()">Добавить</button></div></td>
                </tr>
                <tr>
                  <td colspan="2">
                    <form id="dataForm" onsubmit="submitForm(event)">
                     <table id="elements" class="center">
                      <tbody>
                       <tr>
                          <td><label for="name">Имя:</label></td>
                          <td><input type="text" id="name" name="name" required></td>
                      </tr>
                      </tbody>
                      </table>
                      <input type="submit" value="Добавить данные">
                    </form>
                  </td>
                </tr>
              </table>
            </div>
          </div>
        </td>
      </tr>
      <tr>
        <td class="navigation"><button id="prev">Закрыть</button></td>
        <td class="navigation"><button id="next">Далее</button></td>
      </tr>
    </table>
        <!-- Шаблонный счетчик количества товара -->
        <div id="hide-counter" style="display:none">
          <div class="number" data-step="1" data-min="1" data-max="100">
              <input class="number-text" type="text" name="count" value="1">
              <span class="number-unit">шт</span>
              <div class="number-controls">
                  <a href="#" class="number-plus">+</a>		
                  <a href="#" class="number-minus">−</a>
              </div>
          </div>
      </div>
    <script>
      initComboBox();
      initUserComboBox()
      initNumberCounter();
      var currentPage = 0;
      var maxPage = document.getElementById("pages").children.length-1;
      // Функция для загрузки контента
      function loadContent(page) {
        var pages = document.getElementById("pages").children;
        for(var i=0; i<=maxPage; i++){
          if(i!=page){
            pages[i].setAttribute('style', 'display:none;');
          }
          else{
            pages[i].setAttribute('style', 'display:block;');
          }
        }
      }

      document.getElementById('prev').addEventListener('click', () => {
          if (currentPage > 0) {
              currentPage--;
              loadContent(currentPage);
          }
      });
      document.getElementById('next').addEventListener('click', () => {
        if (currentPage < maxPage){
          currentPage++;
          loadContent(currentPage);
        }
      });</script>

    <script>
      // Устанавливает стиль для светлой\темной темы
      function setThemeClass() {
        document.documentElement.className = Telegram.WebApp.colorScheme;
        beforeLoadPage();
      }
      Telegram.WebApp.onEvent('themeChanged', setThemeClass);
      setThemeClass();
    </script>
  </body>
</html>